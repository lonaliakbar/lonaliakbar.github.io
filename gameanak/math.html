<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monster Math Ceria</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Varela+Round&display=swap" rel="stylesheet">
    <style>
        :root {
            --sky: #81ecec;
            --grass: #55efc4;
            --card: #ffffff;
            --text: #2d3436;
            --accent: #fdcb6e;
        }

        body {
            margin: 0;
            background: linear-gradient(to bottom, var(--sky), #74b9ff); /* Langit */
            font-family: 'Varela Round', sans-serif;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            user-select: none;
        }

        /* --- 1. HIASAN BACKGROUND --- */
        .grass-bg {
            position: absolute; bottom: 0; width: 100%; height: 20vh;
            background: #00b894; border-top: 10px solid #55efc4;
            border-radius: 50% 50% 0 0 / 20px 20px 0 0;
            z-index: -1;
        }
        .cloud {
            position: absolute; background: white; border-radius: 50px; opacity: 0.8;
            animation: floatCloud 20s linear infinite;
        }
        @keyframes floatCloud { from{left:-10%;} to{left:110%;} }

        /* --- 2. HEADER LUCU --- */
        header {
            padding: 2vh 5vw;
            display: flex;
            justify-content: space-between;
            font-family: 'Fredoka One', cursive; /* Font Tebal Kartun */
            color: white;
            text-shadow: 2px 2px 0 rgba(0,0,0,0.2);
            z-index: 10;
        }
        .score-box { font-size: 4vh; background: #fdcb6e; padding: 5px 20px; border-radius: 30px; border: 3px solid white; }
        .level-box { font-size: 3vh; background: #ff7675; padding: 5px 20px; border-radius: 30px; border: 3px solid white; }

        /* --- 3. AREA MONSTER & SOAL --- */
        #game-stage {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        #monster {
            font-size: 18vh;
            filter: drop-shadow(0 10px 0 rgba(0,0,0,0.2));
            transition: transform 0.3s;
            cursor: pointer;
        }
        /* Animasi Mengambang */
        .float-anim { animation: floatMonster 3s ease-in-out infinite; }
        @keyframes floatMonster { 0%,100%{transform:translateY(0);} 50%{transform:translateY(-15px);} }

        /* Kotak Soal */
        #question-bubble {
            background: white;
            padding: 2vh 4vw;
            border-radius: 30px;
            font-size: 6vh;
            font-family: 'Fredoka One', cursive;
            color: #6c5ce7;
            position: relative;
            box-shadow: 0 10px 0 #dfe6e9;
            margin-bottom: 4vh;
            border: 4px solid #a29bfe;
        }
        /* Segitiga bubble chat */
        #question-bubble::after {
            content: ''; position: absolute; bottom: -20px; left: 50%;
            transform: translateX(-50%); border-width: 20px 20px 0;
            border-style: solid; border-color: #a29bfe transparent transparent transparent;
        }

        /* --- 4. TOMBOL JAWABAN (BESAR & BULAT) --- */
        #options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3vh;
            width: 70%;
            max-width: 800px;
        }

        .btn-opt {
            background: white;
            border: none;
            border-radius: 25px;
            font-size: 5vh;
            font-family: 'Fredoka One', cursive;
            color: #555;
            padding: 2vh;
            box-shadow: 0 8px 0 #b2bec3; /* Efek 3D */
            cursor: pointer;
            transition: transform 0.1s, background 0.2s;
        }

        /* Warna-warni tombol */
        .btn-opt:nth-child(1) { color: #e84393; } /* Pink */
        .btn-opt:nth-child(2) { color: #0984e3; } /* Biru */
        .btn-opt:nth-child(3) { color: #00b894; } /* Hijau */
        .btn-opt:nth-child(4) { color: #e17055; } /* Orange */

        /* STATE FOKUS (REMOTE TV) */
        .btn-opt.focused {
            transform: scale(1.05) translateY(-5px);
            background: #ffeaa7; /* Kuning terang */
            box-shadow: 0 15px 0 #fdcb6e, 0 0 30px rgba(255,255,255,0.8);
            z-index: 10;
            border: 4px solid #fff;
        }

        .btn-opt:active { transform: translateY(4px); box-shadow: 0 4px 0 #b2bec3; }

        /* Efek Jawaban */
        .correct-anim { animation: pop 0.3s; background: #55efc4 !important; color: white !important; }
        .wrong-anim { animation: shake 0.4s; background: #ff7675 !important; color: white !important; }
        
        @keyframes pop { 50% { transform: scale(1.2); } }
        @keyframes shake { 0%,100%{transform:translateX(0);} 25%{transform:translateX(-10px);} 75%{transform:translateX(10px);} }

        /* --- 5. EFEK PARTIKEL (CONFETTI) --- */
        .confetti {
            position: absolute; width: 15px; height: 15px; background: #f00;
            animation: fall 1s linear forwards;
        }
        @keyframes fall { to { transform: translateY(100vh) rotate(720deg); opacity: 0; } }

    </style>
</head>
<body>

    <div class="cloud" style="top:10%; left:10%; width:100px; height:40px;"></div>
    <div class="cloud" style="top:20%; left:70%; width:150px; height:60px; animation-duration: 25s;"></div>

    <header>
        <div class="level-box">‚≠ê Level 1</div>
        <div class="score-box">Poin: <span id="score">0</span></div>
    </header>

    <div id="game-stage">
        <div id="monster" class="float-anim">üê•</div>
        
        <div id="question-bubble">Siap?</div>

        <div id="options-grid">
            <button class="btn-opt" id="btn-0">0</button>
            <button class="btn-opt" id="btn-1">0</button>
            <button class="btn-opt" id="btn-2">0</button>
            <button class="btn-opt" id="btn-3">0</button>
        </div>
    </div>

    <div class="grass-bg"></div>

    <script>
        // --- 1. SETUP LOGIKA GAME ---
        let score = 0;
        let correctAnswer = 0;
        let currentFocus = 0;
        const monster = document.getElementById('monster');
        const questionBox = document.getElementById('question-bubble');
        const buttons = [
            document.getElementById('btn-0'),
            document.getElementById('btn-1'),
            document.getElementById('btn-2'),
            document.getElementById('btn-3')
        ];

        // Maskot Emosi
        const mascotHappy = ["üê•", "ü¶Ñ", "üêº", "üê∏"];
        const mascotSad = ["üê£", "üêå"]; 
        let currentMascot = "üê•";

        // --- 2. GENERATE SOAL ---
        function newQuestion() {
            // Angka Kecil (1-10) untuk anak-anak
            const a = Math.floor(Math.random() * 9) + 1;
            const b = Math.floor(Math.random() * 9) + 1;
            
            // Pilih Operator (+ atau -)
            // Pastikan hasil tidak minus
            let isPlus = Math.random() > 0.5;
            if (!isPlus && a < b) isPlus = true; // Paksa plus kalau hasil minus

            if(isPlus) {
                correctAnswer = a + b;
                questionBox.innerText = `${a} + ${b} = ?`;
            } else {
                correctAnswer = a - b;
                questionBox.innerText = `${a} - ${b} = ?`;
            }

            // Generate Opsi Jawaban
            let options = [correctAnswer];
            while(options.length < 4) {
                let rng = Math.floor(Math.random() * 15) + 1; // Jawaban acak
                if(!options.includes(rng) && rng !== correctAnswer) {
                    options.push(rng);
                }
            }
            // Acak posisi
            options.sort(() => Math.random() - 0.5);

            // Masukkan ke tombol
            buttons.forEach((btn, index) => {
                btn.innerText = options[index];
                btn.dataset.val = options[index];
                btn.className = 'btn-opt'; // Reset class
            });

            updateFocus();
        }

        // --- 3. CEK JAWABAN ---
        function check(index) {
            const btn = buttons[index];
            const val = parseInt(btn.dataset.val);

            if(val === correctAnswer) {
                // BENAR
                score += 10;
                document.getElementById('score').innerText = score;
                
                // Efek Visual
                btn.classList.add('correct-anim');
                monster.innerText = mascotHappy[Math.floor(Math.random()*mascotHappy.length)];
                monster.style.transform = "scale(1.3) rotate(10deg)";
                questionBox.innerText = "Hore! üéâ";
                questionBox.style.color = "#00b894";
                
                playSound('win');
                spawnConfetti(); // Efek Hujan

                setTimeout(() => {
                    monster.style.transform = "scale(1)";
                    monster.innerText = currentMascot;
                    questionBox.style.color = "#6c5ce7";
                    newQuestion();
                }, 1000);

            } else {
                // SALAH
                btn.classList.add('wrong-anim');
                monster.innerText = "üêå"; // Jadi siput kalau salah
                questionBox.innerText = "Coba lagi..";
                questionBox.style.color = "#ff7675";
                
                playSound('lose');

                setTimeout(() => {
                    btn.classList.remove('wrong-anim');
                    monster.innerText = currentMascot;
                    // Kembalikan teks soal
                    // (Logika sederhana: user harus ingat soalnya atau kita simpan di var)
                    // Untuk simpelnya, kita generate soal baru saja biar tidak bosan
                    setTimeout(newQuestion, 500); 
                }, 800);
            }
        }

        // --- 4. EFEK VISUAL TAMBAHAN (CONFETTI) ---
        function spawnConfetti() {
            for(let i=0; i<30; i++) {
                const conf = document.createElement('div');
                conf.className = 'confetti';
                conf.style.left = Math.random() * 100 + 'vw';
                conf.style.background = `hsl(${Math.random()*360}, 100%, 50%)`;
                conf.style.animationDuration = (Math.random() * 1 + 0.5) + 's';
                document.body.appendChild(conf);
                setTimeout(() => conf.remove(), 1500);
            }
        }

        // --- 5. AUDIO SYNTH (Biar tidak perlu file mp3) ---
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        function playSound(type) {
            if(audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain); gain.connect(audioCtx.destination);

            if(type==='win') {
                // Nada Do-Mi-Sol (Ceria)
                osc.type = 'triangle';
                osc.frequency.setValueAtTime(523.25, audioCtx.currentTime); // Do
                osc.frequency.setValueAtTime(659.25, audioCtx.currentTime + 0.1); // Mi
                osc.frequency.setValueAtTime(783.99, audioCtx.currentTime + 0.2); // Sol
                gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.4);
                osc.start(); osc.stop(audioCtx.currentTime + 0.4);
            } else if (type==='move') {
                // Klik lembut
                osc.frequency.setValueAtTime(300, audioCtx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);
                osc.start(); osc.stop(audioCtx.currentTime + 0.1);
            } else {
                // Nada rendah (Salah)
                osc.type = 'sawtooth';
                osc.frequency.setValueAtTime(150, audioCtx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
                osc.start(); osc.stop(audioCtx.currentTime + 0.3);
            }
        }

        // --- 6. KONTROL REMOTE / KEYBOARD ---
        function updateFocus() {
            buttons.forEach(b => b.classList.remove('focused'));
            buttons[currentFocus].classList.add('focused');
        }

        document.addEventListener('keydown', (e) => {
            const key = e.keyCode;
            if([37,38,39,40,13].includes(key)) e.preventDefault();

            // Navigasi Grid 2x2
            // 0 1
            // 2 3
            if(key === 37) { // Kiri
                if(currentFocus === 1) currentFocus = 0;
                if(currentFocus === 3) currentFocus = 2;
                playSound('move');
                updateFocus();
            }
            else if(key === 39) { // Kanan
                if(currentFocus === 0) currentFocus = 1;
                if(currentFocus === 2) currentFocus = 3;
                playSound('move');
                updateFocus();
            }
            else if(key === 38) { // Atas
                if(currentFocus >= 2) currentFocus -= 2;
                playSound('move');
                updateFocus();
            }
            else if(key === 40) { // Bawah
                if(currentFocus <= 1) currentFocus += 2;
                playSound('move');
                updateFocus();
            }
            else if(key === 13) { // Enter
                check(currentFocus);
            }
            else if (key === 8 || key === 461) { // Back
                window.history.back();
            }
        });

        // Init Game Pertama Kali
        newQuestion();

        // Support Mouse Click
        buttons.forEach((btn, idx) => {
            btn.onclick = () => {
                currentFocus = idx;
                updateFocus();
                check(idx);
            }
        });

    </script>
</body>
</html>
