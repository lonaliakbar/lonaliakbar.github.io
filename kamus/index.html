<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kamus Basa Acèh - Basa Acèh Foundation</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Merriweather:ital,wght@0,400;0,700;1,400&family=Source+Code+Pro:wght@400;500&display=swap" rel="stylesheet">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f5f5f4; }
        .font-serif { font-family: 'Merriweather', serif; }
        .font-mono { font-family: 'Source Code Pro', monospace; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade-in { animation: fadeIn 0.5s ease-in-out forwards; }
        .tooltip { visibility: hidden; opacity: 0; position: absolute; background-color: #262626; color: #fff; text-align: left; border-radius: 6px; padding: 8px 12px; z-index: 100; bottom: 125%; left: 50%; transform: translateX(-50%); width: max-content; max-width: 300px; font-size: 0.875rem; transition: opacity 0.3s; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .ref-link:hover .tooltip { visibility: visible; opacity: 1; }
    </style>
</head>
<body class="bg-stone-100 subpixel-antialiased">

    <div id="print-area" class="absolute -top-full left-0"></div>

    <div id="loginModal" class="fixed inset-0 bg-gray-800 bg-opacity-75 flex items-center justify-center p-4 z-50 hidden animate-fade-in">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-sm">
            <form id="loginForm">
                <div class="p-6 border-b"><h2 class="text-2xl font-bold text-stone-800">Login Akun</h2></div>
                <div class="p-6 space-y-4">
                    <div><label for="username" class="block text-sm font-medium text-stone-700">Username</label><input type="text" id="username" name="username" required class="mt-1 block w-full border-stone-300 rounded-md shadow-sm focus:border-teal-500 focus:ring-teal-500"></div>
                    <div class="relative">
                        <label for="password" class="block text-sm font-medium text-stone-700">Password</label>
                        <input type="password" id="password" name="password" required class="mt-1 block w-full border-stone-300 rounded-md shadow-sm focus:border-teal-500 focus:ring-teal-500 pr-10">
                        <i class='bx bx-hide text-xl text-stone-400 absolute top-8 right-3 cursor-pointer toggle-password'></i>
                    </div>
                    <p id="loginStatus" class="text-sm text-red-600 pt-2"></p>
                </div>
                <div class="p-6 bg-stone-50 rounded-b-xl"><div class="flex justify-end items-center"><button type="button" class="closeLoginBtn bg-white py-2 px-4 border border-stone-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50">Batal</button><button type="submit" class="ml-3 bg-teal-600 text-white rounded-md py-2 px-6 font-semibold hover:bg-teal-700">Login</button></div><p class="text-xs text-center text-stone-500 mt-4">Belum punya akun? <a href="#" id="showRegisterModal" class="font-semibold text-teal-600 hover:underline">Daftar di sini</a></p></div>
            </form>
        </div>
    </div>
    
    <div id="registerModal" class="fixed inset-0 bg-gray-800 bg-opacity-75 flex items-center justify-center p-4 z-50 hidden animate-fade-in">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-sm">
            <form id="registerForm">
                <div class="p-6 border-b"><h2 class="text-2xl font-bold text-stone-800">Buat Akun Baru</h2></div>
                <div class="p-6 space-y-4">
                    <div><label for="registerNamaLengkap" class="block text-sm font-medium text-stone-700">Nama Lengkap</label><input type="text" id="registerNamaLengkap" required class="mt-1 block w-full border-stone-300 rounded-md shadow-sm focus:border-teal-500 focus:ring-teal-500"></div>
                    <div><label for="registerUsername" class="block text-sm font-medium text-stone-700">Username</label><input type="text" id="registerUsername" required class="mt-1 block w-full border-stone-300 rounded-md shadow-sm focus:border-teal-500 focus:ring-teal-500"></div>
                    <div class="relative">
                        <label for="registerPassword" class="block text-sm font-medium text-stone-700">Password</label>
                        <input type="password" id="registerPassword" required class="mt-1 block w-full border-stone-300 rounded-md shadow-sm focus:border-teal-500 focus:ring-teal-500 pr-10">
                        <i class='bx bx-hide text-xl text-stone-400 absolute top-8 right-3 cursor-pointer toggle-password'></i>
                    </div>
                    <p id="registerStatus" class="text-sm pt-2"></p>
                </div>
                <div class="p-6 bg-stone-50 rounded-b-xl"><div class="flex justify-end items-center"><button type="button" class="closeRegisterBtn bg-white py-2 px-4 border border-stone-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50">Batal</button><button type="submit" class="ml-3 bg-teal-600 text-white rounded-md py-2 px-6 font-semibold hover:bg-teal-700">Daftar</button></div><p class="text-xs text-center text-stone-500 mt-4">Sudah punya akun? <a href="#" id="showLoginModal" class="font-semibold text-teal-600 hover:underline">Login di sini</a></p></div>
            </form>
        </div>
    </div>

    <div id="entryModal" class="fixed inset-0 bg-gray-800 bg-opacity-75 flex items-center justify-center p-4 z-50 hidden animate-fade-in"><div class="bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto"><form id="entryForm"><div class="p-6 border-b flex justify-between items-center sticky top-0 bg-white z-10"><h2 id="modalTitle" class="text-2xl font-bold text-stone-800"></h2><button type="button" class="closeModalBtn text-2xl text-stone-400 hover:text-stone-600">&times;</button></div><div class="p-6 space-y-4"><input type="hidden" id="formAction" name="action"><input type="hidden" id="formRowIndex" name="rowIndex"><div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><label for="formLema" class="block text-sm font-medium text-stone-700">Lema (Kata Utama)</label><input type="text" id="formLema" name="lema" required class="mt-1 block w-full border-stone-300 rounded-md shadow-sm focus:border-teal-500 focus:ring-teal-500"></div><div><label for="formKelas" class="block text-sm font-medium text-stone-700">Kelas Kata</label><input type="text" id="formKelas" name="kelas" class="mt-1 block w-full border-stone-300 rounded-md shadow-sm focus:border-teal-500 focus:ring-teal-500"></div></div><div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><label for="formJawi" class="block text-sm font-medium text-stone-700">Tulisan Jawi</label><input type="text" id="formJawi" name="jawi" class="mt-1 block w-full border-stone-300 rounded-md shadow-sm focus:border-teal-500 focus:ring-teal-500"></div><div><label for="formIpa" class="block text-sm font-medium text-stone-700">IPA (Fonetik)</label><input type="text" id="formIpa" name="ipa" class="mt-1 block w-full border-stone-300 rounded-md shadow-sm focus:border-teal-500 focus:ring-teal-500"></div></div><div><label for="formArti" class="block text-sm font-medium text-stone-700">Arti / Makna</label><textarea id="formArti" name="arti" rows="3" required class="mt-1 block w-full border-stone-300 rounded-md shadow-sm focus:border-teal-500 focus:ring-teal-500"></textarea></div><div id="contohContainer" class="space-y-3 pt-2"><label class="block text-sm font-medium text-stone-700 border-b pb-2 mb-2">Contoh Kalimat</label></div><button type="button" id="addContohBtn" class="text-sm text-teal-600 hover:text-teal-800 font-semibold">+ Tambah Contoh</button><div><label for="formCatatan" class="block text-sm font-medium text-stone-700">Catatan Penggunaan</label><input type="text" id="formCatatan" name="catatan" class="mt-1 block w-full border-stone-300 rounded-md shadow-sm focus:border-teal-500 focus:ring-teal-500"></div><div><label for="formReferensi" class="block text-sm font-medium text-stone-700">Kode Referensi</label><input type="text" id="formReferensi" name="referensi" class="mt-1 block w-full border-stone-300 rounded-md shadow-sm focus:border-teal-500 focus:ring-teal-500" placeholder="cth: AB.85"></div></div><div class="p-6 bg-stone-50 rounded-b-xl flex justify-end items-center space-x-3 sticky bottom-0 z-10"><span id="formStatus" class="text-sm text-green-600 mr-auto"></span><button type="button" class="closeModalBtn bg-white py-2 px-4 border border-stone-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50">Batal</button><button type="submit" id="saveBtn" class="bg-teal-600 text-white rounded-md py-2 px-6 font-semibold hover:bg-teal-700">Simpan</button></div></form></div></div>
    <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-40 border-b border-stone-200"><div class="container mx-auto px-4"><div class="flex items-center justify-between h-20"><div class="flex items-center gap-3"><span class="bg-teal-600 text-white flex items-center justify-center w-10 h-10 rounded-lg text-xl font-bold">B</span><div><h1 class="text-xl font-bold text-stone-800 tracking-tight">Kamus Basa Acèh</h1><p class="text-sm text-stone-500 hidden sm:block">Persembahan Basa Acèh Foundation</p></div></div><div class="flex items-center gap-4"><button id="addWordBtn" title="Tambah Kata Baru" class="flex items-center gap-2 bg-teal-600 text-white text-sm font-semibold px-4 py-2 rounded-lg hover:bg-teal-700 transition-colors shadow-sm hidden"><i class='bx bx-plus text-lg'></i><span class="hidden md:inline">Tambah Kata</span></button><div id="userMenu"></div></div></div></div></header>
    <div id="app-container" class="container mx-auto p-4 md:p-8 max-w-4xl"><main><div id="kataHariIniContainer" class="my-8"></div><form id="searchForm" class="relative mb-8"><input id="searchInput" type="text" placeholder="Cari kata dalam Basa Acèh..." class="w-full pl-6 pr-32 py-4 text-lg border-2 border-stone-300 rounded-full focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition-all duration-300 shadow-sm" /><button type="submit" class="absolute right-2 top-1/2 -translate-y-1/2 bg-teal-600 text-white rounded-full px-8 py-2.5 font-semibold hover:bg-teal-700">Cari</button></form><div id="content"></div></main></div>
    <footer class="bg-white border-t border-stone-200 mt-16"><div class="container mx-auto px-4 py-8"><div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-center md:text-left"><div><h3 class="font-semibold text-stone-800 mb-3">Tentang Kamus</h3><p class="text-sm text-stone-600">Sebuah inisiatif dari Basa Acèh Foundation untuk melestarikan dan mempromosikan kekayaan Basa Acèh melalui kamus digital interaktif.</p></div><div><h3 class="font-semibold text-stone-800 mb-3">Tautan</h3><ul class="space-y-2 text-sm"><li><a href="#" class="text-stone-600 hover:text-teal-600">Kontribusi</a></li><li><a href="#" class="text-stone-600 hover:text-teal-600">Panduan Penggunaan</a></li><li><a href="#" class="text-stone-600 hover:text-teal-600">Tentang Proyek</a></li></ul></div><div><h3 class="font-semibold text-stone-800 mb-3">Terhubung</h3><div class="flex justify-center md:justify-start gap-4 mt-2"><a href="#" title="GitHub" class="text-stone-500 hover:text-teal-600 text-2xl"><i class='bx bxl-github'></i></a><a href="#" title="Instagram" class="text-stone-500 hover:text-teal-600 text-2xl"><i class='bx bxl-instagram-alt'></i></a><a href="#" title="Email" class="text-stone-500 hover:text-teal-600 text-2xl"><i class='bx bxs-envelope'></i></a></div></div></div><div class="border-t border-stone-200 mt-8 pt-6 text-center text-sm text-stone-500"><p>&copy; 2025 Basa Acèh Foundation. Hak Cipta Dilindungi.</p><p class="mt-1">Dibuat di Banda Aceh.</p></div></div></footer>
    <template id="lemaDetailTemplate"><div class="bg-white shadow-xl rounded-xl group relative animate-fade-in"><div class="p-6 md:p-8"><div class="card-actions absolute top-4 right-4 flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity"><button class="edit-btn bg-stone-100 text-stone-500 h-8 w-8 rounded-full hover:bg-teal-100 hover:text-teal-700 flex items-center justify-center hidden" title="Edit Kata Ini"><i class='bx bx-pencil text-lg'></i></button></div><div class="flex items-center border-b border-stone-200 pb-4 mb-4"><div><h1 class="text-3xl md:text-4xl font-bold text-stone-800 data-lema"></h1><p class="text-xl text-stone-600 font-serif mt-1 data-jawi"></p></div><div class="ml-auto flex items-center"><span class="text-lg text-stone-500 font-mono data-ipa"></span></div></div><p class="text-md text-teal-700 italic mb-6 data-kelas"></p><div class="definisi-container space-y-6"></div><div class="mt-8 border-t border-stone-200 pt-6 data-catatan-container"><h3 class="font-semibold text-stone-700 mb-2">Catatan Penggunaan</h3><p class="text-stone-600 bg-amber-50 border border-amber-200 p-4 rounded-lg data-catatan"></p></div></div><div class="card-footer bg-stone-50 rounded-b-xl px-6 py-3 border-t border-stone-200"><button class="print-btn flex items-center gap-2 text-sm text-stone-500 hover:text-teal-600 font-semibold transition"><i class='bx bxs-printer text-lg'></i>Cetak ke PDF</button></div></div></template>
    <template id="definisiEntryTemplate"><div><p class="text-lg text-stone-800"><span class="font-bold text-stone-500 mr-2 data-nomor"></span><span class="data-makna"></span></p><div class="text-right mt-1 data-sumber-container relative"></div><div class="border-l-4 border-teal-100 bg-stone-50 p-3 mt-2 rounded-r-lg data-contoh-container space-y-4"></div></div></template>
    <template id="contohFormTemplate"><div class="contoh-entry p-3 border rounded-md bg-stone-50"><input type="text" name="contohAceh" placeholder="Contoh kalimat Aceh" class="block w-full border-stone-300 rounded-md shadow-sm text-sm"><input type="text" name="contohInd" placeholder="Terjemahan Indonesia" class="mt-2 block w-full border-stone-300 rounded-md shadow-sm text-sm"><button type="button" class="remove-contoh-btn text-xs text-red-500 hover:text-red-700 mt-2 font-semibold">Hapus Contoh</button></div></template>
    <template id="kataHariIniTemplate"><div class="bg-teal-800 text-white p-6 rounded-xl shadow-lg animate-fade-in"><h2 class="text-xl font-bold mb-2 opacity-80">Kata Hari Ini</h2><div class="flex items-baseline"><p class="text-4xl font-bold data-lema"></p><p class="ml-4 text-xl italic text-teal-200 data-kelas"></p></div><p class="mt-2 text-teal-100 data-arti"></p></div></template>
    <template id="emptyStateTemplate"><div class="text-center py-16 text-stone-500"><p>Gunakan bilah pencarian di atas untuk menemukan arti kata.</p></div></template>
    <template id="notFoundStateTemplate"><div class="text-center py-16 text-stone-600 bg-white rounded-xl shadow-xl animate-fade-in"><h3 class="text-2xl font-bold text-stone-800">Kata Tidak Ditemukan</h3><p class="mt-2 max-w-md mx-auto">Kami tidak dapat menemukan kata yang Anda cari. Mohon periksa kembali ejaan Anda atau coba kata kunci lain.</p></div></template>
    <template id="loadingStateTemplate"><div class="text-center py-20 animate-fade-in"><i class='bx bx-loader-alt text-5xl text-teal-600 animate-spin'></i><p class="mt-3 text-stone-600">Mencari...</p></div></template>

    <script>
        $(document).ready(function() {
            const API_URL = "https://script.google.com/macros/s/AKfycbwX1A2y-sraHQUy1IOtjhXLHvpTPurCSLrDXVShSwtrwRegwvmTmz62WS-yZjwsAYE7/exec";
            let kamusData = null;
            const referensiData = [ { kode: "AB.85", penulis: "Aboe Bakar, dkk.", judul: "Kamus Aceh-Indonesia", detail: "Pusat Pembinaan dan Pengembangan Bahasa, 1985." }, { kode: "SCH.93", penulis: "C. Snouck Hurgronje", judul: "De Atjehers", detail: "Batavia: Landsdrukkerij, 1893." }, { kode: "MD.85", penulis: "Mark Durie", judul: "A Grammar of Acehnese: On the Basis of a Dialect of North Aceh", detail: "Foris Publications, 1985." } ];
            function normalizeString(str) { if (!str) return ''; return str.normalize('NFD').replace(/[\u0300-\u036f]/g, ''); }
            function saveSession(data) { localStorage.setItem('sessionToken', data.token); localStorage.setItem('userData', JSON.stringify(data.user)); updateUIForLoggedInUser(data.user); }
            function clearSession() { localStorage.removeItem('sessionToken'); localStorage.removeItem('userData'); updateUIForLoggedOutUser(); }
            function getSession() { const token = localStorage.getItem('sessionToken'); const userData = JSON.parse(localStorage.getItem('userData')); return token && userData ? { token, user: userData } : null; }
            function updateUIForLoggedInUser(user) { $('#userMenu').html(`<div class="flex items-center gap-3"><span class="font-semibold text-sm">${user.nama_lengkap}</span><button id="logoutBtn" class="text-sm bg-stone-200 hover:bg-stone-300 px-3 py-1 rounded-md">Logout</button></div>`); if (user.peran === 'admin' || user.peran === 'editor') { $('#addWordBtn').removeClass('hidden'); $('#content').find('.edit-btn').removeClass('hidden'); } }
            function updateUIForLoggedOutUser() { $('#userMenu').html(`<button id="loginBtn" class="text-sm font-semibold text-stone-600 hover:text-teal-600">Login</button>`); $('#addWordBtn').addClass('hidden'); $('#content').find('.edit-btn').addClass('hidden'); }
            async function fetchKamusData() { try { const response = await fetch(`${API_URL}?sheet=Kamus&v=${new Date().getTime()}`); if (!response.ok) throw new Error('Network response not ok'); kamusData = await response.json(); return kamusData; } catch (err) { console.error("Gagal memuat data:", err); $('#content').html(`<p class="text-center text-red-600 font-semibold">Gagal Memuat Data.</p>`); return []; } }
            function showLoader() { $('#content').html($('#loadingStateTemplate').html()); }
            function renderKataHariIni(kata) { const el = $($('#kataHariIniTemplate').html()); el.find('.data-lema').text(kata.lema); el.find('.data-kelas').text(kata.kelas); el.find('.data-arti').text(kata.arti); $('#kataHariIniContainer').html(el); }
            function renderHasilPencarian(results) { const content = $('#content').html(''); if (!results || results.length === 0) { content.html($('#searchInput').val().trim() ? $('#notFoundStateTemplate').html() : $('#emptyStateTemplate').html()); return; } const resultsContainer = $('<div class="space-y-6"></div>'); results.forEach((data, index) => { const el = $($('#lemaDetailTemplate').html()); el.data('full-data', data); el.find('.data-lema').html(results.length > 1 ? `<sup class="text-teal-600 font-bold text-xl mr-1">${index + 1}</sup>${data.lema}` : data.lema); data.jawi ? el.find('.data-jawi').text(data.jawi) : el.find('.data-jawi').hide(); data.ipa ? el.find('.data-ipa').text(data.ipa) : el.find('.data-ipa').hide(); data.kelas ? el.find('.data-kelas').text(data.kelas) : el.find('.data-kelas').hide(); const defEl = $($('#definisiEntryTemplate').html()); defEl.find('.data-makna').text(data.arti || 'Tidak ada definisi.'); if (data.referensi) { const refDetail = referensiData.find(ref => ref.kode === data.referensi); if (refDetail) { defEl.find('.data-sumber-container').append($(`<span class="ref-link text-teal-600 font-mono cursor-pointer hover:underline"> [${data.referensi}] <span class="tooltip"><b>${refDetail.penulis}</b><br><em>${refDetail.judul}</em><br>${refDetail.detail}</span></span>`)); } } const contohContainer = defEl.find('.data-contoh-container').html(''); let examplesFound = 0; for (let i = 1; i <= 10; i++) { if (data[`contoh${i}Aceh`] && data[`contoh${i}Ind`]) { examplesFound++; contohContainer.append(`<div class="flex"><i class='bx bxs-quote-alt-left text-stone-300 text-lg mr-2 mt-1 flex-shrink-0'></i><div><p class="italic text-stone-700">${data[`contoh${i}Aceh`]}</p><p class="text-stone-600 mt-1 text-sm">${data[`contoh${i}Ind`]}</p></div></div>`); } } if (examplesFound === 0) contohContainer.hide(); el.find('.definisi-container').append(defEl); data.catatan ? el.find('.data-catatan').text(data.catatan) : el.find('.data-catatan-container').hide(); resultsContainer.append(el); }); content.append(resultsContainer); const session = getSession(); if (session && (session.user.peran === 'admin' || session.user.peran === 'editor')) { content.find('.edit-btn').removeClass('hidden'); } }
            function openModal(data = null) { $('#entryForm')[0].reset(); $('#contohContainer').find('.contoh-entry').remove(); $('#formStatus').text('').removeClass('text-red-500'); if (data) { $('#modalTitle').text('Edit Kata'); $('#formAction').val('edit'); $('#formRowIndex').val(data.rowIndex); Object.keys(data).forEach(key => $(`#form${key.charAt(0).toUpperCase() + key.slice(1)}`).val(data[key])); for (let i = 1; i <= 10 && data[`contoh${i}Aceh`]; i++) addContohField(data[`contoh${i}Aceh`], data[`contoh${i}Ind`]); } else { $('#modalTitle').text('Tambah Kata Baru'); $('#formAction').val('add'); addContohField(); } $('#entryModal').removeClass('hidden'); }
            function closeModal(modalId) { $(modalId).addClass('hidden'); }
            function addContohField(aceh = '', ind = '') { const el = $($('#contohFormTemplate').html()); el.find('input[name="contohAceh"]').val(aceh); el.find('input[name="contohInd"]').val(ind); $('#contohContainer').append(el); }
            async function handleFormSubmit(e) { e.preventDefault(); const session = getSession(); if (!session) return alert("Sesi Anda telah berakhir."); const saveBtn = $('#saveBtn').prop('disabled', true).text('Menyimpan...'); let formData = { token: session.token }; $(this).serializeArray().forEach(item => formData[item.name] = item.value); $('.contoh-entry').each((index, el) => { formData[`contoh${index + 1}Aceh`] = $(el).find('input[name="contohAceh"]').val(); formData[`contoh${index + 1}Ind`] = $(el).find('input[name="contohInd"]').val(); }); try { await fetch(API_URL, { method: 'POST', mode: 'no-cors', body: JSON.stringify(formData) }); $('#formStatus').text('Berhasil! Memuat ulang data...'); setTimeout(() => { closeModal('#entryModal'); initialize(); }, 1500); } catch (error) { $('#formStatus').text('Gagal menyimpan.').addClass('text-red-500'); } finally { saveBtn.prop('disabled', false).text('Simpan'); } }
            async function initialize() { updateUIForLoggedOutUser(); const session = getSession(); if (session) updateUIForLoggedInUser(session.user); showLoader(); const data = await fetchKamusData(); if (data && data.length > 0) { renderKataHariIni(data[Math.floor(Math.random() * data.length)]); renderHasilPencarian([]); } }
            initialize();
            
            // --- EVENT LISTENERS ---
            $('#searchForm').on('submit', (e) => { e.preventDefault(); $('#kataHariIniContainer').slideUp(); showLoader(); setTimeout(() => renderHasilPencarian(kamusData.filter(item => normalizeString(item.lema.toLowerCase()).includes(normalizeString($('#searchInput').val().toLowerCase().trim())))), 800); });
            $('#addWordBtn').on('click', () => openModal(null));
            $('.closeModalBtn').on('click', () => closeModal('#entryModal')); $('.closeLoginBtn').on('click', () => closeModal('#loginModal')); $('.closeRegisterBtn').on('click', () => closeModal('#registerModal'));
            $('#addContohBtn').on('click', () => addContohField());
            $('#entryForm').on('submit', handleFormSubmit);
            $('#userMenu').on('click', '#loginBtn', () => $('#loginModal').removeClass('hidden'));
            $('#userMenu').on('click', '#logoutBtn', clearSession);
            $('#showRegisterModal').on('click', (e) => { e.preventDefault(); closeModal('#loginModal'); $('#registerModal').removeClass('hidden'); });
            $('#showLoginModal').on('click', (e) => { e.preventDefault(); closeModal('#registerModal'); $('#loginModal').removeClass('hidden'); });
            $('#contohContainer').on('click', '.remove-contoh-btn', function() { $(this).closest('.contoh-entry').remove(); });
            $('#content').on('click', '.edit-btn', function() { openModal($(this).closest('.group').data('full-data')); });
            $('#content').on('click', '.print-btn', function() { const cardToPrint = $(this).closest('.group'); const lema = cardToPrint.data('full-data').lema || 'entri'; const cardClone = cardToPrint.clone().find('.card-actions, .card-footer').remove().end(); $('#print-area').html(cardClone); html2pdf().from($('#print-area').children().first().get(0)).set({ margin: 0.5, filename: `kamus-basa-aceh-${normalizeString(lema.toLowerCase())}.pdf`, image: { type: 'jpeg', quality: 0.98 }, html2canvas: { scale: 2 }, jsPDF: { unit: 'in', format: 'letter' } }).save().then(() => $('#print-area').html('')); });
            $('#loginForm').on('submit', async function(e) { e.preventDefault(); $('#loginStatus').text('Mencoba login...'); try { const response = await fetch(API_URL, { method: 'POST', body: JSON.stringify({ action: 'login', username: $('#username').val(), password: $('#password').val() }) }); const result = await response.json(); if (result.success) { saveSession(result); closeModal('#loginModal'); $(this)[0].reset(); $('#loginStatus').text(''); } else { $('#loginStatus').text(result.message || 'Login gagal.'); } } catch (error) { $('#loginStatus').text('Terjadi kesalahan jaringan.'); } });
            $('#registerForm').on('submit', async function(e) { e.preventDefault(); const statusEl = $('#registerStatus').text('Mendaftarkan...').removeClass('text-red-600 text-green-600'); const password = $('#registerPassword').val(); if(password.length < 6){ statusEl.text('Password minimal 6 karakter.').addClass('text-red-600'); return; } try { const response = await fetch(API_URL, { method: 'POST', body: JSON.stringify({ action: 'register', nama_lengkap: $('#registerNamaLengkap').val(), username: $('#registerUsername').val(), password: password }) }); const result = await response.json(); if (result.success) { statusEl.text(result.message).addClass('text-green-600'); setTimeout(() => { closeModal('#registerModal'); $('#loginModal').removeClass('hidden'); $(this)[0].reset(); statusEl.text(''); }, 2000); } else { statusEl.text(result.message || 'Pendaftaran gagal.').addClass('text-red-600'); } } catch (error) { statusEl.text('Terjadi kesalahan jaringan.').addClass('text-red-600'); } });
            // [PERBAIKAN] Event listener untuk toggle password
            $('body').on('click', '.toggle-password', function() {
                $(this).toggleClass('bx-show bx-hide');
                const input = $(this).prev('input');
                input.attr('type', input.attr('type') === 'password' ? 'text' : 'password');
            });
        });
    </script>
</body>
</html>
